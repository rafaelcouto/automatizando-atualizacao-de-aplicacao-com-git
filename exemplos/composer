#!/bin/bash

# Armazenando argumentos em vari치veis
read oldrev newrev ref

# Armazenando caminho do c칩digo fonte em vari치vel
worktree=/var/www/deploy-automatico

echo "Atualizando c칩digo fonte"
git --work-tree="$worktree" checkout -f

if git --work-tree="$worktree" diff --name-only $oldrev $newrev | grep "^composer\.json$" -q; then
    echo "Atualizando bibliotecas"
    composer --working-dir=$worktree update --no-interaction
fi